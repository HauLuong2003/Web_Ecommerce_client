@page "/order-list"

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Order List</h3>
            </div>
            <div class="card-body">
                 
                <div class="row">
                    
                      <p><a class="btn btn-success float-end" href="/add-order"> Add New Order </a></p>

                    <InputSelect TValue="int" @bind-Value="selectedOrderStatusId" @onchange="SearchStatus" class="form-control custom-select">
                        <option value="">Select status</option>
                                @foreach (OrderStatus orderS in orderStatus)
                                {
                                    <option value="@orderS.OrderSatatusId">@orderS.Status</option>
                                }
                    </InputSelect>
                   
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header"></div>
                            @if (orderList == null || !orderList.Any())
                            {
                                <div class="alert alert-info">There are no products available.</div>
                            }
                            else
                            {
                                <div class="card-body">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>Id</th>
                                                <th>Fullname</th>
                                                <th>Email</th>
                                                <th>PhoneNumber</th>
                                                <th>Address</th>
                                                <th>TotalMoney</th>
                                                <th>ShippingCost</th>
                                                <th>OrderStatus</th>
                                                <th>Payment</th>
                                               
                                                <th>Create_At</th>
                                                <th>Edit</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (Oder product in orderList)
                                            {
                                                <tr>
                                                    <td>@product.OrderId</td>
                                                    <td>@product.Fullname</td>
                                                    <td>@product.Email</td>
                                                    <td>@product.PhoneNumber </td>
                                                    <td>@product.Address</td>
                                                    <td>@product.TotalMoney</td>
                                                    <td>@product.ShippingCost</td>
                                                    <td>@product.OrderStatus.Status</td>
                                                    <td>@product.Payment.Method</td>
                                                   
                                                    <td>@product.OderDate</td>
       
                                                    <td>
                                                        <a class="btn btn-danger" href="/Order/delete/@product.OrderId"> Delete </a>
                                                    </td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            }

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@code {
    public List<Oder> orderList = new();
    public List<OrderStatus> orderStatus = new List<OrderStatus>();
    private int selectedOrderStatusId;
    protected override async Task OnInitializedAsync()
    {
        await LoadOrders();
        orderStatus = await orderService.OrderStatus();

    }
    private async Task LoadOrders()
    {
        orderList = await orderService.GetOrder();

    }
    private async Task SearchStatus(ChangeEventArgs e)
    {
        selectedOrderStatusId = int.Parse(e.Value.ToString());
        orderList = await orderService.GetOderStatus(selectedOrderStatusId);
        
    }

}


